!function(t,e){"function"==typeof define&&define.amd?define(["jquery"],function(n){return e(t,n)}):"object"==typeof exports?e(t,require("jquery")):e(t,t.jQuery)}("undefined"!=typeof window?window:this,function(t,e){"use strict";function n(t,e){for(var n=t.length;--n;)if(Math.round(+t[n])!==Math.round(+e[n]))return!1;return!0}function i(t){var n={range:!0,animate:!0};return"boolean"==typeof t?n.animate=t:e.extend(n,t),n}function o(t,n,i,o,a,s,r,c,h){"array"===e.type(t)?this.elements=[+t[0],+t[2],+t[4],+t[1],+t[3],+t[5],0,0,1]:this.elements=[t,n,i,o,a,s,r||0,c||0,h||1]}function a(t,e,n){this.elements=[t,e,n]}function s(t,n){if(!(this instanceof s))return new s(t,n);1!==t.nodeType&&e.error("Panzoom called on non-Element node"),e.contains(r,t)||e.error("Panzoom element must be attached to the document");var i=e.data(t,c);if(i)return i;this.options=n=e.extend({},s.defaults,n),this.elem=t;var o=this.$elem=e(t);this.$set=n.$set&&n.$set.length?n.$set:o,this.$doc=e(t.ownerDocument||r),this.$parent=o.parent(),this.parent=this.$parent[0],this.isSVG=d.test(t.namespaceURI)&&"svg"!==t.nodeName.toLowerCase(),this.panning=!1,this._buildTransform(),this._transform=e.cssProps.transform.replace(m,"-$1").toLowerCase(),this._buildTransition(),this.resetDimensions();var a=e(),h=this;e.each(["$zoomIn","$zoomOut","$zoomRange","$reset"],function(t,e){h[e]=n[e]||a}),this.enable(),this.scale=this.getMatrix()[0],this._checkPanWhenZoomed(),e.data(t,c,this)}var r=t.document,c="__pz__",h=Array.prototype.slice,p=/trident\/7./i,l=function(){if(p.test(navigator.userAgent))return!1;var t=r.createElement("input");return t.setAttribute("oninput","return"),"function"==typeof t.oninput}(),m=/([A-Z])/g,d=/^http:[\w\.\/]+svg$/,u="(\\-?\\d[\\d\\.e-]*)",f="\\,?\\s*",g=new RegExp("^matrix\\("+u+f+u+f+u+f+u+f+u+f+u+"\\)$");return o.prototype={x:function(t){var e=t instanceof a,n=this.elements,i=t.elements;return e&&3===i.length?new a(n[0]*i[0]+n[1]*i[1]+n[2]*i[2],n[3]*i[0]+n[4]*i[1]+n[5]*i[2],n[6]*i[0]+n[7]*i[1]+n[8]*i[2]):i.length===n.length&&new o(n[0]*i[0]+n[1]*i[3]+n[2]*i[6],n[0]*i[1]+n[1]*i[4]+n[2]*i[7],n[0]*i[2]+n[1]*i[5]+n[2]*i[8],n[3]*i[0]+n[4]*i[3]+n[5]*i[6],n[3]*i[1]+n[4]*i[4]+n[5]*i[7],n[3]*i[2]+n[4]*i[5]+n[5]*i[8],n[6]*i[0]+n[7]*i[3]+n[8]*i[6],n[6]*i[1]+n[7]*i[4]+n[8]*i[7],n[6]*i[2]+n[7]*i[5]+n[8]*i[8])},inverse:function(){var t=1/this.determinant(),e=this.elements;return new o(t*(e[8]*e[4]-e[7]*e[5]),t*-(e[8]*e[1]-e[7]*e[2]),t*(e[5]*e[1]-e[4]*e[2]),t*-(e[8]*e[3]-e[6]*e[5]),t*(e[8]*e[0]-e[6]*e[2]),t*-(e[5]*e[0]-e[3]*e[2]),t*(e[7]*e[3]-e[6]*e[4]),t*-(e[7]*e[0]-e[6]*e[1]),t*(e[4]*e[0]-e[3]*e[1]))},determinant:function(){var t=this.elements;return t[0]*(t[8]*t[4]-t[7]*t[5])-t[3]*(t[8]*t[1]-t[7]*t[2])+t[6]*(t[5]*t[1]-t[4]*t[2])}},a.prototype.e=o.prototype.e=function(t){return this.elements[t]},s.rmatrix=g,s.defaults={eventNamespace:".panzoom",transition:!0,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,which:1,increment:.3,linearZoom:!1,panOnlyWhenZoomed:!1,minScale:.3,maxScale:6,rangeStep:.05,duration:200,easing:"ease-in-out",contain:!1},s.prototype={constructor:s,instance:function(){return this},enable:function(){this._initStyle(),this._bind(),this.disabled=!1},disable:function(){this.disabled=!0,this._resetStyle(),this._unbind()},isDisabled:function(){return this.disabled},destroy:function(){this.disable(),e.removeData(this.elem,c)},resetDimensions:function(){this.container=this.parent.getBoundingClientRect();var t=this.elem,n=t.getBoundingClientRect(),i=Math.abs(this.scale);this.dimensions={width:n.width,height:n.height,left:e.css(t,"left",!0)||0,top:e.css(t,"top",!0)||0,border:{top:e.css(t,"borderTopWidth",!0)*i||0,bottom:e.css(t,"borderBottomWidth",!0)*i||0,left:e.css(t,"borderLeftWidth",!0)*i||0,right:e.css(t,"borderRightWidth",!0)*i||0},margin:{top:e.css(t,"marginTop",!0)*i||0,left:e.css(t,"marginLeft",!0)*i||0}}},reset:function(t){t=i(t);var e=this.setMatrix(this._origTransform,t);t.silent||this._trigger("reset",e)},resetZoom:function(t){t=i(t);var e=this.getMatrix(this._origTransform);t.dValue=e[3],this.zoom(e[0],t)},resetPan:function(t){var e=this.getMatrix(this._origTransform);this.pan(e[4],e[5],i(t))},setTransform:function(t){for(var n=this.$set,i=n.length;i--;)e.style(n[i],"transform",t),this.isSVG&&n[i].setAttribute("transform",t)},getTransform:function(t){var n=this.$set,i=n[0];return t?this.setTransform(t):(t=e.style(i,"transform"),!this.isSVG||t&&"none"!==t||(t=e.attr(i,"transform")||"none")),"none"===t||g.test(t)||this.setTransform(t=e.css(i,"transform")),t||"none"},getMatrix:function(t){var e=g.exec(t||this.getTransform());return e&&e.shift(),e||[1,0,0,1,0,0]},setMatrix:function(t,n){if(!this.disabled){n||(n={}),"string"==typeof t&&(t=this.getMatrix(t));var i=+t[0],o="undefined"!=typeof n.contain?n.contain:this.options.contain;if(o){var a=n.dims;a||(this.resetDimensions(),a=this.dimensions);var s,r,c,h=this.container,p=a.width,l=a.height,m=h.width,d=h.height,u=m/p,f=d/l;"center"!==this.$parent.css("textAlign")||"inline"!==e.css(this.elem,"display")?(c=(p-this.elem.offsetWidth)/2,s=c-a.border.left,r=p-m-c+a.border.right):s=r=(p-m)/2;var g=(l-d)/2+a.border.top,v=(l-d)/2-a.border.top-a.border.bottom;"invert"===o||"automatic"===o&&u<1.01?t[4]=Math.max(Math.min(t[4],s-a.border.left),-r):t[4]=Math.min(Math.max(t[4],s),-r),"invert"===o||"automatic"===o&&f<1.01?t[5]=Math.max(Math.min(t[5],g-a.border.top),-v):t[5]=Math.min(Math.max(t[5],g),-v)}if("skip"!==n.animate&&this.transition(!n.animate),n.range&&this.$zoomRange.val(i),this.options.disableXAxis||this.options.disableYAxis){var b=this.getMatrix();this.options.disableXAxis&&(t[4]=b[4]),this.options.disableYAxis&&(t[5]=b[5])}return this.setTransform("matrix("+t.join(",")+")"),this.scale=i,this._checkPanWhenZoomed(i),n.silent||this._trigger("change",t),t}},isPanning:function(){return this.panning},transition:function(t){if(this._transition)for(var n=t||!this.options.transition?"none":this._transition,i=this.$set,o=i.length;o--;)e.style(i[o],"transition")!==n&&e.style(i[o],"transition",n)},pan:function(t,e,n){if(!this.options.disablePan){n||(n={});var i=n.matrix;i||(i=this.getMatrix()),n.relative&&(t+=+i[4],e+=+i[5]),i[4]=t,i[5]=e,this.setMatrix(i,n),n.silent||this._trigger("pan",i[4],i[5])}},zoom:function(t,n){"object"==typeof t?(n=t,t=null):n||(n={});var i=e.extend({},this.options,n);if(!i.disableZoom){var s=!1,r=i.matrix||this.getMatrix(),c=+r[0];"number"!=typeof t&&(t=i.linearZoom?c+i.increment*(t?-1:1):t?c/(1+i.increment):c*(1+i.increment),s=!0),t=Math.max(Math.min(t,i.maxScale),i.minScale);var h=i.focal;if(h&&!i.disablePan){this.resetDimensions();var p=i.dims=this.dimensions,l=h.clientX,m=h.clientY;this.isSVG||(l-=p.width/c/2,m-=p.height/c/2);var d=new a(l,m,1),u=new o(r),f=this.parentOffset||this.$parent.offset(),g=new o(1,0,f.left-this.$doc.scrollLeft(),0,1,f.top-this.$doc.scrollTop()),v=u.inverse().x(g.inverse().x(d)),b=t/r[0];u=u.x(new o([b,0,0,b,0,0])),d=g.x(u.x(v)),r[4]=+r[4]+(l-d.e(0)),r[5]=+r[5]+(m-d.e(1))}r[0]=t,r[3]="number"==typeof i.dValue?i.dValue:t,this.setMatrix(r,{animate:"undefined"!=typeof i.animate?i.animate:s,range:!i.noSetRange}),i.silent||this._trigger("zoom",r[0],i)}},option:function(t,n){var i;if(!t)return e.extend({},this.options);if("string"==typeof t){if(1===arguments.length)return void 0!==this.options[t]?this.options[t]:null;i={},i[t]=n}else i=t;this._setOptions(i)},_setOptions:function(t){e.each(t,e.proxy(function(t,n){switch(t){case"disablePan":this._resetStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._unbind()}switch(this.options[t]=n,t){case"disablePan":this._initStyle();case"$zoomIn":case"$zoomOut":case"$zoomRange":case"$reset":this[t]=n;case"disableZoom":case"onStart":case"onChange":case"onZoom":case"onPan":case"onEnd":case"onReset":case"eventNamespace":this._bind();break;case"cursor":e.style(this.elem,"cursor",n);break;case"minScale":this.$zoomRange.attr("min",n);break;case"maxScale":this.$zoomRange.attr("max",n);break;case"rangeStep":this.$zoomRange.attr("step",n);break;case"startTransform":this._buildTransform();break;case"duration":case"easing":this._buildTransition();case"transition":this.transition();break;case"panOnlyWhenZoomed":this._checkPanWhenZoomed();break;case"$set":n instanceof e&&n.length&&(this.$set=n,this._initStyle(),this._buildTransform())}},this))},_checkPanWhenZoomed:function(t){var e=this.options;if(e.panOnlyWhenZoomed){t||(t=this.getMatrix()[0]);var n=t<=e.minScale;e.disablePan!==n&&this.option("disablePan",n)}},_initStyle:function(){var t={"transform-origin":this.isSVG?"0 0":"50% 50%"};this.options.disablePan||(t.cursor=this.options.cursor),this.$set.css(t);var n=this.$parent;n.length&&!e.nodeName(this.parent,"body")&&(t={overflow:"hidden"},"static"===n.css("position")&&(t.position="relative"),n.css(t))},_resetStyle:function(){this.$elem.css({cursor:"",transition:""}),this.$parent.css({overflow:"",position:""})},_bind:function(){var t=this,n=this.options,i=n.eventNamespace,o="mousedown"+i+" pointerdown"+i+" MSPointerDown"+i,a="touchstart"+i+" "+o,r="touchend"+i+" click"+i+" pointerup"+i+" MSPointerUp"+i,c={},h=this.$reset,p=this.$zoomRange;if(e.each(["Start","Change","Zoom","Pan","End","Reset"],function(){var t=n["on"+this];e.isFunction(t)&&(c["panzoom"+this.toLowerCase()+i]=t)}),n.disablePan&&n.disableZoom||(c[a]=function(e){var i;("touchstart"===e.type?!(i=e.touches||e.originalEvent.touches)||(1!==i.length||n.disablePan)&&2!==i.length:n.disablePan||(e.which||e.originalEvent.which)!==n.which)||(e.preventDefault(),e.stopPropagation(),t._startMove(e,i))},3===n.which&&(c.contextmenu=!1)),this.$elem.on(c),h.length&&h.on(r,function(e){e.preventDefault(),t.reset()}),p.length&&p.attr({step:n.rangeStep===s.defaults.rangeStep&&p.attr("step")||n.rangeStep,min:n.minScale,max:n.maxScale}).prop({value:this.getMatrix()[0]}),!n.disableZoom){var m=this.$zoomIn,d=this.$zoomOut;m.length&&d.length&&(m.on(r,function(e){e.preventDefault(),t.zoom()}),d.on(r,function(e){e.preventDefault(),t.zoom(!0)})),p.length&&(c={},c[o]=function(){t.transition(!0)},c[(l?"input":"change")+i]=function(){t.zoom(+this.value,{noSetRange:!0})},p.on(c))}},_unbind:function(){this.$elem.add(this.$zoomIn).add(this.$zoomOut).add(this.$reset).off(this.options.eventNamespace)},_buildTransform:function(){return this._origTransform=this.getTransform(this.options.startTransform)},_buildTransition:function(){if(this._transform){var t=this.options;this._transition=this._transform+" "+t.duration+"ms "+t.easing}},_getDistance:function(t){var e=t[0],n=t[1];return Math.sqrt(Math.pow(Math.abs(n.clientX-e.clientX),2)+Math.pow(Math.abs(n.clientY-e.clientY),2))},_getMiddle:function(t){var e=t[0],n=t[1];return{clientX:(n.clientX-e.clientX)/2+e.clientX,clientY:(n.clientY-e.clientY)/2+e.clientY}},_trigger:function(t){"string"==typeof t&&(t="panzoom"+t),this.$elem.triggerHandler(t,[this].concat(h.call(arguments,1)))},_startMove:function(t,i){if(!this.panning){var o,a,s,c,h,p,l,m,d=this,u=this.options,f=u.eventNamespace,g=this.getMatrix(),v=g.slice(0),b=+v[4],y=+v[5],M={matrix:g,animate:"skip"},w=t.type;"pointerdown"===w?(o="pointermove",a="pointerup"):"touchstart"===w?(o="touchmove",a="touchend"):"MSPointerDown"===w?(o="MSPointerMove",a="MSPointerUp"):(o="mousemove",a="mouseup"),o+=f,a+=f,this.transition(!0),this.panning=!0,this._trigger("start",t,i);var x=function(t,e){if(e){if(2===e.length){if(null!=s)return;return s=d._getDistance(e),c=+g[0],void(h=d._getMiddle(e))}if(null!=p)return;(m=e[0])&&(p=m.pageX,l=m.pageY)}null==p&&(p=t.pageX,l=t.pageY)};x(t,i);var z=function(t){var e;if(t.preventDefault(),i=t.touches||t.originalEvent.touches,x(t,i),i){if(2===i.length){var n=d._getMiddle(i),o=d._getDistance(i)-s;return d.zoom(o*(u.increment/100)+c,{focal:n,matrix:g,animate:"skip"}),d.pan(+g[4]+n.clientX-h.clientX,+g[5]+n.clientY-h.clientY,M),void(h=n)}e=i[0]||{pageX:0,pageY:0}}e||(e=t),d.pan(b+e.pageX-p,y+e.pageY-l,M)};e(r).off(f).on(o,z).on(a,function(t){t.preventDefault(),e(this).off(f),d.panning=!1,t.type="panzoomend",d._trigger(t,g,!n(g,v))})}}},e.Panzoom=s,e.fn.panzoom=function(t){var n,i,o,a;return"string"==typeof t?(a=[],i=h.call(arguments,1),this.each(function(){n=e.data(this,c),n?"_"!==t.charAt(0)&&"function"==typeof(o=n[t])&&void 0!==(o=o.apply(n,i))&&a.push(o):a.push(void 0)}),a.length?1===a.length?a[0]:a:this):this.each(function(){new s(this,t)})},s});var ModularityInteractiveMap={},ModularityInteractiveMap=ModularityInteractiveMap||{};ModularityInteractiveMap.Categories=function(t){function e(){this.handleEvents()}return e.prototype.handleEvents=function(){t("[data-interactive-map-category]").on("change",function(e){var n=t(e.target).closest("input"),i=n.attr("data-interactive-map-category");n.prop("checked")?this.toggleCategoryAssets(i,"show"):this.toggleCategoryAssets(i,"hide")}.bind(this))},e.prototype.toggleCategoryAssets=function(e,n){var i=t("[data-interactive-map-category]:checked"),o=[];i.each(function(e,n){o.push(t(this).attr("data-interactive-map-category"))}),t("[data-interactive-map-category-name]").each(function(e,n){var i=t(this).attr("data-interactive-map-category-name");i=i.split("|"),t(i).filter(o).length?t(this).show():t(this).hide()})},new e}(jQuery);var ModularityInteractiveMap=ModularityInteractiveMap||{};ModularityInteractiveMap.PinTooltip=function(t){function e(){this.handleEvents(),t(window).resize(function(){t(".mod-interactive-map-pin-info").addClass("mod-interactive-map-pin-info-hidden")}),t(window).on("orientationchange",function(e){t(".mod-interactive-map-pin-info").addClass("mod-interactive-map-pin-info-hidden")})}return e.prototype.handleEvents=function(){t(".mod-interactive-map-pin").on("click touchstart",function(t){t.preventDefault(),this.populateTooltip(t),this.showTooltip(t),this.placeTooltip(t)}.bind(this)),t("[data-interactive-map-close-tooltip]").on("click touchstart",function(t){t.preventDefault(),this.hideTooltip(t)}.bind(this))},e.prototype.populateTooltip=function(e){toolTip=t(".mod-interactive-map-pin-info",t(e.target).parent().parent().parent()),t("h3",toolTip).html(t(e.target).attr("data-title")),t(".description",toolTip).html(t(e.target).attr("data-description")),t(e.target).attr("data-link")?t(".link",toolTip).attr("href",t(e.target).attr("data-link")).show(0):t(".link",toolTip).attr("href",t(e.target).attr("data-link")).hide(0)},e.prototype.showTooltip=function(e){t(".mod-interactive-map-pin-info",t(e.target).parent().parent().parent()).removeClass("mod-interactive-map-pin-info-hidden")},e.prototype.hideTooltip=function(e){t(".mod-interactive-map-pin-info",t(e.target).parent().parent().parent()).addClass("mod-interactive-map-pin-info-hidden")},e.prototype.placeTooltip=function(e){toolTip=t(".mod-interactive-map-pin-info",t(e.target).parent().parent().parent()),t(toolTip).offset(t(e.target).offset())},new e}(jQuery);var ModularityInteractiveMap=ModularityInteractiveMap||{};ModularityInteractiveMap.Zoom=function(t){function e(){this.init(),this.resize(),window.addEventListener("orientationchange",function(){this.resize()}.bind(this),!1),window.addEventListener("resize",function(){this.resize()}.bind(this),!1)}return e.prototype.init=function(){t(".mod-interactive-map-container").each(function(e,n){t(".mod-interactive-map-zoomable",n).panzoom({$zoomIn:t(".zoom-in",n),$zoomOut:t(".zoom-out",n),duration:150,panOnlyWhenZoomed:!1,minScale:1,maxScale:t("img",n).get(0).naturalWidth/t("img",n).get(0).clientWidth,increment:.1,contain:!1}),t("button",n).click(function(){t(".mod-interactive-map-zoomable",t(this).parent().parent()).panzoom("resetPan"),t(".mod-interactive-map-pin-info").addClass("mod-interactive-map-pin-info-hidden"),t(this).parent().parent().removeClass(function(t,e){return(e.match(/(^|\s)zoomlevel-\S+/g)||[]).join(" ")}).addClass("zoomlevel-"+Math.ceil(t(".mod-interactive-map-zoomable",t(this).parent().parent()).get(0).getBoundingClientRect().width/t(".mod-interactive-map-zoomable",t(this).parent().parent()).get(0).offsetWidth))})})},e.prototype.resize=function(t){},e.prototype.resize=function(){t(".mod-interactive-map-container").each(function(e,n){t(".mod-interactive-map-zoomable",n).panzoom("option","maxScale",t("img",n).get(0).naturalWidth/t("img",n).get(0).clientWidth),t("img",n).get(0).naturalWidth/t("img",n).get(0).clientWidth<1.4?t(".mod-iteractive-map-buttons",n).addClass("mod-interactive-map-pin-info-hidden"):t(".mod-iteractive-map-buttons",n).removeClass("mod-interactive-map-pin-info-hidden"),t(".mod-interactive-map-zoomable",n).panzoom("reset")})},new e}(jQuery);